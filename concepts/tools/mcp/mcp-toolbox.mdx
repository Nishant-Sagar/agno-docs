---
title: MCP Toolbox
sidebarTitle: MCP Toolbox
description: Learn how to use MCPToolbox with Agno to connect to MCP Toolbox for Databases with tool filtering capabilities.
---

The `MCPToolbox` class extends Agno's `MCPTools` functionality to provide integration with [MCP Toolbox for Databases](https://googleapis.github.io/genai-toolbox/getting-started/introduction/). It combines MCP server connectivity with the toolbox-core client to filter tools by toolset or tool name.

## Key Features

- **Tool Filtering**: Load specific toolsets or individual tools instead of all available tools
- **Database Integration**: Works with MCP Toolbox for Databases server
- **Authentication Support**: Built-in support for authentication tokens via `auth_token_getters`
- **Parameter Binding**: Pre-configure tool parameters with `bound_params`

## Installation

```bash
pip install toolbox-core
```

## Basic Usage

### Loading Specific Toolsets

```python
import asyncio
from textwrap import dedent
from agno.agent import Agent
from agno.tools.mcp_toolbox import MCPToolbox

url = "http://127.0.0.1:5001"

async def run_agent(message: str = None) -> None:
    """Run an interactive CLI for the GitHub agent with the given message."""

    # Approach 1: Load specific toolset at initialization
    async with MCPToolbox(
        url=url, toolsets=["hotel-management", "booking-system"]
    ) as db_tools:
        print(db_tools.functions)  # Print available tools for debugging
        # returns a list of tools from a toolset
        agent = Agent(
            tools=[db_tools],
            instructions=dedent(
                """ \
                You're a helpful hotel assistant. You handle hotel searching, booking and
                cancellations. When the user searches for a hotel, mention it's name, id,
                location and price tier. Always mention hotel ids while performing any
                searches. This is very important for any operations. For any bookings or
                cancellations, please provide the appropriate confirmation. Be sure to
                update checkin or checkout dates if mentioned by the user.
                Don't ask for confirmations from the user.
            """
            ),
            markdown=True,
            show_tool_calls=True,
            add_history_to_messages=True,
            debug_mode=True,
        )

        # Run an interactive command-line interface to interact with the agent.
        await agent.acli_app(message=message, stream=True)

if __name__ == "__main__":
    asyncio.run(run_agent(message=None))
```

### Manual Tool Loading

```python
async def run_agent_manual_loading(message: str) -> None:
    """Alternative approach: Manual loading with custom auth parameters."""

    # Approach 2: Manual loading with custom auth parameters
    async with MCPToolbox(url=url) as toolbox:  # No filter parameters
        # Load specific toolsets with custom auth
        hotel_tools = await toolbox.load_toolset(
            "hotel-management",
            auth_token_getters={"hotel_api": lambda: "your-hotel-api-key"},
            bound_params={"region": "us-east-1"},
        )

        booking_tools = await toolbox.load_toolset(
            "booking-system",
            auth_token_getters={"booking_api": lambda: "your-booking-api-key"},
            bound_params={"environment": "production"},
        )

        # Combine tools as needed
        selected_tools = []
        selected_tools.extend(hotel_tools)
        selected_tools.extend(booking_tools[:2])  # Only first 2 booking tools

        agent = Agent(
            tools=selected_tools,
            instructions=dedent(
                """ \
                You're a helpful hotel assistant. You handle hotel searching, booking and
                cancellations. When the user searches for a hotel, mention it's name, id,
                location and price tier. Always mention hotel ids while performing any
                searches. This is very important for any operations. For any bookings or
                cancellations, please provide the appropriate confirmation. Be sure to
                update checkin or checkout dates if mentioned by the user.
                Don't ask for confirmations from the user.
            """
            ),
            markdown=True,
            show_tool_calls=True,
            add_history_to_messages=True,
            debug_mode=True,
        )

        await agent.acli_app(message=message, stream=True)
```

### Without Context Manager

```python
async def run_agent_no_ctx_manager(message: str = None) -> None:
    """Run an interactive CLI for the GitHub agent with the given message."""

    # Approach 1: Load specific toolset at initialization
    toolbox = MCPToolbox(url=url, toolsets=["hotel-management", "booking-system"])

    await toolbox.connect()

    agent = Agent(
        tools=[toolbox],
        instructions=dedent(
            """ \
            You're a helpful hotel assistant. You handle hotel searching, booking and
            cancellations. When the user searches for a hotel, mention it's name, id,
                location and price tier. Always mention hotel ids while performing any
                searches. This is very important for any operations. For any bookings or
                cancellations, please provide the appropriate confirmation. Be sure to
                update checkin or checkout dates if mentioned by the user.
                Don't ask for confirmations from the user.
            """
        ),
        markdown=True,
        show_tool_calls=True,
        add_history_to_messages=True,
        debug_mode=True,
    )

    await agent.acli_app(message=message, stream=True)
```

## Configuration Options

| Parameter | Type | Description |
|-----------|------|-------------|
| `url` | `str` | Base URL for the toolbox service |
| `toolsets` | `Optional[List[str]]` | List of toolset names to filter tools by |
| `tool_name` | `Optional[str]` | Single tool name to load |
| `headers` | `Optional[Dict[str, Any]]` | HTTP headers for requests |
| `transport` | `str` | MCP transport protocol (default: "streamable-http") |

<Note>
Only one of `toolsets` or `tool_name` can be specified.
</Note>

## Key Methods

- `async connect()`: Connect to MCP server and toolbox client
- `async load_tool(tool_name, auth_token_getters={}, bound_params={})`: Load single tool
- `async load_toolset(toolset_name, auth_token_getters={}, bound_params={})`: Load toolset
- `async load_multiple_toolsets(toolset_names, ...)`: Load multiple toolsets
- `get_client()`: Get underlying ToolboxClient
- `async close()`: Close connections

## Demo Setup

Complete demo available in `cookbook/tools/mcp/mcp_toolbox_demo/`:

### Docker Compose

```yaml
services:
  toolbox:
    image: us-central1-docker.pkg.dev/database-toolbox/toolbox/toolbox:latest
    ports:
      - "5001:5000"
    volumes:
      - ./config:/config
    command: ["toolbox", "--tools-file", "/config/tools.yaml", "--address", "0.0.0.0"]
    depends_on:
      db:
        condition: service_healthy

  db:
    image: postgres:16
    environment:
      POSTGRES_USER: toolbox_user
      POSTGRES_PASSWORD: my-password
      POSTGRES_DB: toolbox_db
    ports:
      - "5432:5432"
    volumes:
      - ./config/init.sql:/docker-entrypoint-initdb.d/init.sql
```

### Tool Configuration

```yaml
sources:
  my-pg-source:
    kind: postgres
    host: db
    port: 5432
    database: toolbox_db
    user: toolbox_user
    password: my-password

tools:
  search-hotels-by-name:
    kind: postgres-sql
    source: my-pg-source
    description: Search for hotels based on name.
    parameters:
      - name: name
        type: string
        description: The name of the hotel.
    statement: SELECT * FROM hotels WHERE name ILIKE '%' || $1 || '%';
    
  book-hotel:
    kind: postgres-sql
    source: my-pg-source
    description: Book a hotel by its ID.
    parameters:
      - name: hotel_id
        type: string
        description: The ID of the hotel to book.
    statement: UPDATE hotels SET booked = B'1' WHERE id = $1;

toolsets:
  hotel-management:
    - search-hotels-by-name
    - search-hotels-by-location
    - find-hotels-by-tier-and-location
  booking-system:
    - book-hotel
    - update-hotel
    - cancel-hotel
```

## Running the Demo

```bash
cd cookbook/tools/mcp/mcp_toolbox_demo
docker-compose up -d
uv sync
export OPENAI_API_KEY="your_openai_api_key"
uv run agent.py
```

## Available Examples

- **[Basic Agent](https://github.com/agno-agi/agno/blob/main/cookbook/tools/mcp/mcp_toolbox_demo/agent.py)** (`agent.py`): Simple hotel assistant
- **[AgentOS Integration](https://github.com/agno-agi/agno/blob/main/cookbook/tools/mcp/mcp_toolbox_demo/agent_os.py)** (`agent_os.py`): With AgentOS control plane
- **[Workflow Integration](https://github.com/agno-agi/agno/blob/main/cookbook/tools/mcp/mcp_toolbox_demo/hotel_management_workflows.py)** (`hotel_management_workflows.py`): Using in workflows
- **[Type-Safe Agent](https://github.com/agno-agi/agno/blob/main/cookbook/tools/mcp/mcp_toolbox_demo/hotel_management_typesafe.py)** (`hotel_management_typesafe.py`): Pydantic models
- **[Complete Demo](https://github.com/agno-agi/agno/tree/main/cookbook/tools/mcp/mcp_toolbox_demo)**: Full demo with Docker setup and README

## Related Documentation

- [MCP Overview](/concepts/tools/mcp/mcp)
- [MCP Transports](/concepts/tools/mcp/transports/streamable_http)

For more information, visit the [MCP Toolbox documentation](https://googleapis.github.io/genai-toolbox/getting-started/introduction/).
